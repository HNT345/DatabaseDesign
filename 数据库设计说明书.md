参考文档：[点这里](https://wenku.baidu.com/view/fcccbc33168884868662d625.html)
实际例子：[点这里](https://wenku.baidu.com/view/0176e7eb856a561252d36f56.html)

# 目录
- 1 引言
    - 1.1 编写目的
    - 1.2 背景
    - 1.3 定义
    - 1.4 参考资料
- 2 外部设计
    - 2.1 标识符和状态
    - 2.2 使用它的程序
    - 2.3 约定
    - 2.4 支持软件
- 3 结构设计
    - 3.1 概念结构设计
    - 3.2 逻辑结构设计
    - 3.3 物理结构设计
- 4 运用设计
    - 4.1 数据字典设计
    - 4.2 安全保密设计



# 1 引言

## 1.1 编写目的
1、本数据库设计说明书旨在详细描述轻量级团队协作办公解决方案“17”中的数据库结构和设计，包括逻辑结构设计、数据字典设计、安全保密设计等，清晰明确并结构化地将本项目系统的数据库结构和设计方案传递给相关项目参与人员，加深开发者对项目的了解程度，并且可以有助于尽早发现和减少项目的需求错误，帮助成员更好的融入到项目中。

2、本数据库设计说明书读者：用户、系统设计人员、系统测试人员、系统维护人员。

3、本数据库设计说明书是系统详细设计、用户验收的依据之一。

## 1.2 背景
近几年在线协作变得流行，各大厂商纷纷把工作转移至云端，让用户真正可以随时随地不受设备限制地处理任何工作，还可以实时协作，这种趋势对办公场景下的效率提升是很有帮助的。2020年突如其来的疫情使手机、互联网在生活工作中成为了我们最重要的东西。在这样的大环境下，线上工作的重要性尤为突出。本项目是名为《17》，是一款轻量级团队在线协作项目，提出和开发团队均为2017级福州大学软件工程的一根藤上七朵花小组，主要用户为有线上办公协作需求的人群。

## 1.3 定义
本文用到的术语符合国家标准《软件工程术语（GB/T11475-1995）》。

## 1.4 参考资料
本文的参考资料如下：



# 2 外部设计

## 2.1 标识符和状态
数据库软件的名称：

数据库的名称：

## 2.2 使用它的程序
本数据使用于“17” v1.0.0

## 2.3 约定
数据库命名约定：

数据库设计约定：

## 2.4 支持软件
本数据库支持XXX，XXX，XXX等数据库管理系统。


# 3 结构设计

## 3.1 概念结构设计
### 1. 用户模块

#### 1.1用户信息

用户信息（账号、头像、用户名、密码、所在地、个人主页地址、已加入项目）

已加入项目（项目编号、项目名称）

账号（绑定邮箱号、绑定手机号）

实体关联约束：

+ 一位用户仅拥有一个账号，一个账号也仅被一位用户所拥有。
+ 一位用户可以加入多个项目，一个项目可以有多位用户参与。

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/用户信息.png)

#### 1.2 修改信息

修改密码（新密码，旧密码）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/修改密码.png)

---

### 2. 项目模块

项目（项目任务、人员信息）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/项目.png)

#### 2.1 项目任务

项目任务（项目编号、项目名称、子任务、参与者、发起人、开始时间、截止时间、关联内容、优先级、状态、标签、提醒、查看权限、备注信息）

属性约束：

+ 优先级：普通=0、紧急=1、非常紧急=2

+ 查看权限：隐私=0，公开=1

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/项目任务.png)

子任务（任务编号、任务名称、任务地址）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/子任务.png)

参与者（账号、头像、用户名）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/参与者.png)

提醒（时间、提醒对象）

提醒对象（账号、头像、用户名）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/提醒.png)

 实体关联约束：

+ 一个提醒可以作用于多个对象，一个对象可以被多个提醒作用。



标签（名称、编号）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/标签.png)

发起人（账号、用户名）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/发起人.png)

关联内容（内容编号、内容名称、内容地址）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/关联内容.png)

#### 2.2 人员信息

人员信息（参与者、动态）

动态（编号、时间、头像、账号、类型、用户名）

类型（修改任务、回复、加入任务、完成任务、取消任务、创建任务、退出任务、发布消息）

属性约束：

+ 类型：创建任务=1，删除任务=2，取消任务=3，修改任务=4，加入任务=5，退出任务=6，回复=7，发布消息=8

实体关联约束：

+ 一个人员可以发布多条动态，一个动态仅由一人发布。
+ 一个类型可以有多个被动态拥有，一个动态仅有一种类型。

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/人员信息.png)

---

### 3.功能模块

#### 3.1 日程安排

日程（编号，内容，标签，提醒时间，设置时间，备注）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/日程.png)

#### 3.2 文件管理

文件管理（文件编号、创建者、大小、名称、所在位置、更新时间）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/文件管理.png)

#### 3.3 文件协作

文件协作（记录）

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/文档协作.png)

#### 3.4 聊天

群组（编号）

实体关联约束：

+ 项目成员可以划分成多个可重复的群组，一个群组可以由多个项目成员构成。
+ 一个群组对应一个群聊，一个群聊是一个群组。

备注：每个群组都有群聊的方法，私聊相当于只有两个人的群组。

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/聊天.png)

#### 3.5 消息通知

通知（时间，名称，任务）

任务（状态，备注，截止时间，名称，任务所在位置，执行者，开始时间）

属性约束：

+ 状态：已完成=1，未完成=0

实体关联约束：

+ 一个通知只包含一个任务内容，一个任务仅通知一次。

![](https://raw.githubusercontent.com/HNT345/DatabaseDesign/master/数据库设计ER图/通知.png)

---

## 3.2 逻辑结构设计
#### 1.用户表（User）记录用户的个人信息

| 字段名     | 数据类型  | 长度 | 主键 | 非空 | 描述               |
| ---------- | --------- | ---- | ---- | ---- | ------------------ |
| id         | int       |      | 是   | 否   | 用户编号 自增id    |
| uid        | varchar   | 50   |      | 否   | 唯一用户标识       |
| name       | varchar   | 100  |      | 否   | 用户名             |
| password   | varchar   | 128  |      | 否   | 密码（加密后入表） |
| photo      | varchar   | 200  |      |      | 头像url地址        |
| location   | varchar   | 500  |      |      | 所在地             |
| website    | varchar   | 200  |      |      | 个人主页地址       |
| createtime | timestamp |      |      |      | 创建时间           |
| updatetime | timestamp |      |      |      | 更新时间           |
| deletetime | timestamp |      |      |      | 删除时间           |

#### 2.项目表（Project）记录每个项目的信息

| 字段名     | 数据类型  | 长度 | 主键 | 非空 | 描述                            |
| ---------- | --------- | ---- | ---- | ---- | ------------------------------- |
| pid        | int       |      | 是   | 否   | 项目编号（项目唯一标识）自增pid |
| name       | varchar   | 100  |      | 否   | 项目名                          |
| promoter   | int       |      |      |      | 发起人id                        |
| t_begin    | timestamp |      |      |      | 开始时间                        |
| t_end      | timestamp |      |      |      | 截止时间                        |
| priority   | tinyint   |      |      |      | 优先级                          |
| state      | tinyint   |      |      |      | 状态                            |
| warn       | tinyint   |      |      |      | 提醒编号                        |
| authority  | tinyint   |      |      |      | 查看权限                        |
| remarks    | varchar   | 500  |      |      | 备注                            |
| createtime | timestamp |      |      |      | 创建时间                        |
| updatetime | timestamp |      |      |      | 更新时间                        |
| deletetime | timestamp |      |      |      | 删除时间                        |

#### 3.绑定表（Bind）记录账号所绑定的邮箱和手机号信息

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 描述 |
| ------ | -------- | ---- | ---- | ---- | ---- |
| uid    | varchar  | 50   | 是   | 否   | 账号 |
| email  | varchar  | 50   |      |      | 邮箱 |
| tel    | varchar  | 11   |      |      | 电话 |

#### 4.关联内容表（Context）记录关联信息

| 字段名  | 数据类型 | 长度 | 主键 | 非空 | 描述                 |
| ------- | -------- | ---- | ---- | ---- | -------------------- |
| cid     | int      |      | 是   | 否   | 关联内容编号 自增cid |
| name    | varchar  | 50   |      | 否   | 关联内容名           |
| website | varchar  | 200  |      |      | 内容所在地址         |

#### 5.标签表（Label）记录标签信息

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 描述     |
| ------ | -------- | ---- | ---- | ---- | -------- |
| lid    | int      |      | 是   | 否   | 自增lid  |
| name   | varchar  | 20   |      |      | 标签名称 |

#### 6.提醒表（Remind）记录用户提醒信息

| 字段名 | 数据类型  | 长度 | 主键 | 非空 | 描述             |
| ------ | --------- | ---- | ---- | ---- | ---------------- |
| rid    | int       |      | 是   | 否   | 提醒编号 自增rid |
| uid    | int       |      | 是   | 否   | 提醒用户编号     |
| time   | timestamp |      |      |      | 提醒时间         |

#### 7.群组表（Group）记录群组划分情况组成群聊

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 描述             |
| ------ | -------- | ---- | ---- | ---- | ---------------- |
| gid    | int      |      | 是   | 否   | 群组编号 自增gid |
| uid    | int      |      | 是   | 否   | 群组成员编号     |

#### 8.子任务表（Child）记录项目所划分的部分

| 字段名  | 数据类型 | 长度 | 主键 | 非空 | 描述       |
| ------- | -------- | ---- | ---- | ---- | ---------- |
| id      | int      |      | 是   | 否   | 任务编号   |
| pid     | int      |      |      |      | 父任务编号 |
| name    | varchar  | 100  |      | 否   | 任务名称   |
| address | varchar  | 200  |      |      | 任务地址   |

#### 9.动态表（Action）记录参与者的动态信息

| 字段名  | 数据类型  | 长度 | 主键 | 非空 | 描述               |
| ------- | --------- | ---- | ---- | ---- | ------------------ |
| aid     | int       |      | 是   | 否   | 动态编号 自增aid   |
| uid     | int       |      |      | 否   | 发布动态的用户编号 |
| time    | timestamp |      |      |      | 发布时间           |
| type    | tinyint   |      |      |      | 动态类型           |
| context | varchar   | 200  |      |      | 动态内容           |

#### 10.日程表（Schedule）记录用户的日程安排

| 字段名   | 数据类型  | 长度 | 主键 | 非空 | 描述             |
| -------- | --------- | ---- | ---- | ---- | ---------------- |
| sid      | int       |      | 是   | 否   | 日程编号 自增sid |
| context  | varchar   | 500  |      |      | 内容             |
| user     | int       |      |      | 否   | 用户编号         |
| remarks  | varchar   | 500  |      |      | 备注             |
| t_remind | timestamp |      |      |      | 提醒时间         |
| t_set    | timestamp |      |      |      | 设置时间         |

#### 11.通知表（Inform）记录消息通知情况

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 描述             |
| ------ | -------- | ---- | ---- | ---- | ---------------- |
| user   | int      |      | 是   | 否   | 被通知用户的编号 |
| name   | varchar  | 100  |      |      | 通知标题         |
| item   | int      |      |      |      | 通知任务的编号   |

#### 12.文件管理表（File）记录文件情况

| 字段名   | 数据类型  | 长度 | 主键 | 非空 | 描述             |
| -------- | --------- | ---- | ---- | ---- | ---------------- |
| fid      | int       |      | 是   | 否   | 文件编号 自增fid |
| creator  | varchar   | 100  |      |      | 文件创建者       |
| name     | varchar   | 100  |      |      | 文件名           |
| location | varchar   | 200  |      |      | 文件所在位置     |
| u_time   | timestamp |      |      |      |                  |
| size     | double    |      |      |      | 文件大小         |

#### 13.项目参与表（ProjectUser）记录项目和参与者的对应关系

| 字段名   | 数据类型  | 长度 | 主键 | 非空 | 描述     |
| -------- | --------- | ---- | ---- | ---- | -------- |
| pid      | int       |      | 是   | 否   | 项目编号 |
| uid      | int       |      | 是   | 否   | 用户编号 |
| t_attend | timestamp |      |      |      | 加入时间 |
| identity | varchar   | 100  |      |      | 身份     |

#### 14.项目关联内容表（ProjectContext）记录项目和关联内容的对应关系

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 描述         |
| ------ | -------- | ---- | ---- | ---- | ------------ |
| pid    | int      |      | 是   | 否   | 项目编号     |
| cid    | int      |      | 是   | 否   | 关联内容编号 |

#### 15.项目标签表（ProjectLabel）记录项目的标签

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 描述     |
| ------ | -------- | ---- | ---- | ---- | -------- |
| pid    | int      |      | 是   | 否   | 项目编号 |
| lid    | int      |      | 是   | 否   | 标签编号 |

#### 16.日程标签表（Schedulelabel）记录日程和标签的对应关系

| 字段名 | 数据类型 | 长度 | 主键 | 非空 | 描述     |
| ------ | -------- | ---- | ---- | ---- | -------- |
| sid    | int      |      | 是   | 否   | 日程编号 |
| lid    | int      |      | 是   | 否   | 标签编号 |



---

## 3.3 物理结构设计

#### 1. 数据的存储结构

#### 2. 数据的存取路径

#### 3. 数据的存放位置

#### 4. 系统配置








# 4 运用设计

## 4.1 数据字典设计
#### 1.项目任务优先级（priority）

| 状态类 | 状态类名称 |
| ------ | ---------- |
| 0      | 普通       |
| 1      | 紧急       |
| 2      | 非常紧急   |

#### 2.任务项目查看权限（authority）

| 状态类 | 状态类名称 |
| ------ | ---------- |
| 0      | 隐私       |
| 1      | 公开       |

#### 3.人员动态类型（type）

| 状态类 | 状态类名称 |
| ------ | ---------- |
| 1      | 创建任务   |
| 2      | 删除任务   |
| 3      | 取消任务   |
| 4      | 修改任务   |
| 5      | 加入任务   |
| 6      | 退出任务   |
| 7      | 回复       |
| 8      | 发布消息   |

#### 4.任务状态类型（state）

| 状态类 | 状态类名称 |
| ------ | ---------- |
| 0      | 未完成     |
| 1      | 已完成     |



## 4.2 安全保密设计

（说明在数据库的设计中，如何通过区分不同的访问者、不同的访问类型和不同的数据对象，进行分别对待而获得的数据库安全保密的设计考虑）




